set :base_url, 'http://endo-sample.maruware.com'

get '/articles' do
  expect(body: ->{ at(0)[:title] }).to eq 'good'
  expect(body: ->{ at(1)[:title] }).to include 'b'
  expect(body: ->{ map{|e| e[:id]} }).to include 2
end

get '/articles/:article_id' do
  param :article_id do
    from :get, '/articles', ->{ first[:id] }
  end

  expect(header: 'Content-Type').to eq 'application/json; charset=utf-8'
end

post '/articless' do
  param :title, 'hello'
  param :text, 'Hello, world!'
end